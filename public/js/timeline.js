!function(){"use strict";class e{constructor(e,n){this.rootElement=e,this.containerElement=n,this.triggerElement=n.lastElementChild,this.getItems=()=>{},this.isLoading=!1,this.observer=null,this.observing=!1}loadPolyfillIfNeeded(e){if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)e();else{const n=document.createElement("script");n.src="/js/intersection-observer.js",n.onload=e,document.head.appendChild(n)}}start(){this.loadPolyfillIfNeeded((()=>{const e={root:this.rootElement,rootMargin:"0px",threshold:1};this.observer=new IntersectionObserver(((e,n)=>{this.trigger(e,n)}),e),this.observer.observe(this.triggerElement),this.observing=!0,console.log("infinite scroll ready...")}))}async trigger(e,n){for(let n=0;n<e.length;n++){const t=e[n];!1===this.isLoading&&t.isIntersecting&&t.intersectionRatio>=.75&&(this.isLoading=!0,this.observer.unobserve(this.triggerElement),this.containerElement.append(await this.getItems()),this.triggerElement=this.containerElement.lastElementChild,this.observing&&this.observer.observe(this.triggerElement),this.isLoading=!1)}}}!function(e){var n=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));if(n)n[2]}("XSRF-TOKEN");function n(e){return"#"==e.charAt(0)?document.querySelector(e):document.querySelectorAll(e)}function t(e){const n=function(e){switch(e.media){case"tulisan":return`<a class="button my-2" href="${e.url}"> Baca Artikel</a>`;case"podcast":return`<div class="button is-large is-rounded is-success"\n                        onclick="playMedia('${e.url}', this)"> Dengar Podcast </div>`;case"video":return`<div class="button is-large is-rounded is-danger"\n                        onclick="playMedia('${e.url}', this)"> Nonton Video </div>`;default:return""}}(e),t=document.createElement("li");return t.innerHTML=`\n            <article class="media">\n                <div class="media-content">\n                    <div class="level is-mobile mb-2">\n                        <div class="level-left">\n                            <figure class="image is-32x32 is-inline-block">\n                            <img class="is-rounded" alt="foto profil ${e.user.username}" loading="lazy" src="${e.user.avatar_url}">\n                            </figure> \n                            <small class="is-size-7 ml-2">\n                                <strong> ${null!=e.owner?e.owner:""} Â· </strong>  ${e.published_diff} <br>\n                                <span>Dimasukkan oleh: ${e.user.fullname} @${e.user.username}</span>\n                            </small>  \n                        </div>\n                    </div>\n\n                    <div class="content">\n                        <h2 class="is-size-4 mb-1"> <a href="${e.url}" target="_blank"> ${e.title} </a></h2>\n                        <p>${e.body.substring(0,150)}</p>\n\n                        <div class="media-player is-${e.media} ${e.thumbnail?"has-thumbnail":"no-thumbnail"}">\n                           ${null!=e.thumbnail?`<img lazy="loading" src="${e.thumbnail}" alt="thumbnail ${e.title}" width="100%" height="auto">`:""}\n                        \n                            ${null!=n?n:""}\n                        </div>\n\n                        <p class="is-size-7">\n                            <span class="tag is-info is-light"> ${e.media} </span>\n                        </p>\n                    </div>\n                </div>\n            </article>`,t.className="box",t}function i(e){var n=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));if(n)return n[2]}window.addEventListener("load",(()=>{!function(){let s=1,r=999;const a=n("#timeline"),o=n("#main-container"),l=new e(o,a);l.getItems=async function(){const e=document.querySelector("#loading-bar"),n=document.createDocumentFragment();if(r<=s)console.log("Observer stop"),l.observing=!1;else{e.className="loading",s++;const a=await async function(e){const n=new URL(window.location.href),t={page:e,type:"json"};n.search=new URLSearchParams(t).toString();const s=await fetch(n,{credentials:"same-origin",headers:{"Content-Type":"application/json","X-XSRF-TOKEN":i("XSRF-TOKEN")}});return await s.json()}(s);if(a.data){r=parseInt(a.meta.last_page);for(let e=0;e<a.data.length;e++){const i=t(a.data[e]);n.appendChild(i)}}e.className=""}return n},l.start()}()}))}();
